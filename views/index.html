<!DOCTYPE html>
<html lang="en">
<head>
    <%- include viewport/meta.html %>
    <title><%= title %></title>
    <%- include viewport/links.html %>
    <%- include viewport/scripts.html %>
</head>
<body>
    <div class="mycontainer">
        <%- include viewport/menu.html %>
        <div class="ui main container mycontent">
            <div data-bind="module: palette, visible: !loading()"></div>
            <div id="loading" data-bind="visible: loading()">
                <div class='rabbit'></div>
                <div class='clouds'></div>
            </div>
        </div>
        <%- include viewport/footer.html %>
    </div>
    <%- include viewport/unitTest.html %>
    <script type="text/javascript">
        require(["knockout", "jquery", "Tools", "Super", "ko-amd"], function (ko, $, Tools, Super) {
            ko.bindingHandlers.module.baseDir = "apps/<%= appName %>/modules";
            ko.amdTemplateEngine.defaultPath = "apps/<%= appName %>/templates";

            $.getJSON("apps/<%= appName %>/rev-manifest.json?v=" + Tools.guid("xxxxxxxxxxxx"), function (mapping) {
                params.mapping          = mapping;
                params.mapping.getJS    = Tools.getMappingFunc('.min.js', 3);
                params.mapping.getTemp  = Tools.getMappingFunc('.tmpl.html', 10);

                var self = Super.call({}, { parent: null, data: params });

                self.palette({
                    name    : self.data.mapping.getJS("main"),
                    template: self.data.mapping.getTemp("main"),
                    data    : { parent: self, data: self.data }
                });

                ko.applyBindings(self);

                if (self.data.test) {
                    index = self;
                }
            });
        });
    </script>
</body>
</html>
