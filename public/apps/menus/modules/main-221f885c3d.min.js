define(["knockout","jquery","Tools","ko-mapping","semantic"],function(e,u,n){return function(s){var o=this;o.parent=s.parent,o.data=s.data,o.root=o.data.menus[0],o.menuList=e.observableArray(e.mapping.fromJS(o.root.subMenu)()),o.updateMenu=function(){o.root.subMenu=e.mapping.toJS(o.menuList),n.ajax({url:"/menus/update",data:{menus:[o.root]},success:function(e){console.log(e)}})},o.getNewNode=function(){return e.mapping.fromJS({menuId:"",menuName:"",desc:"",link:"",level:"",subMenu:[]})},o._focusMenu=e.observable(o.getNewNode()),o.focusMenu=e.observable(e.utils.extend(o.getNewNode(),{submenus:o.menuList})),o.focusMenuLevel=e.observable(0),o.backToRoot=function(){o._focusMenu(o.getNewNode()),o.focusMenu(e.utils.extend(o.getNewNode(),{submenus:o.menuList})),o.focusMenuLevel(0)},o.editMenu=function(e){var u=o.getNewNode();u.id(this.id()),u.text(this.text()),u.description(this.description()),u.link("javascript:void(0);"==this.link()?"":this.link()),o.focusMenu(this),o._focusMenu(u),o.focusMenuLevel(e)},o.reset=function(){o._focusMenu(o.getNewNode())},o.isEmpty=function(){return""==o._focusMenu().id()&&""==o._focusMenu().text()&&""==o._focusMenu().description()&&""==o._focusMenu().link()},o.saveChange=function(){o.focusMenu().id(o._focusMenu().id()),o.focusMenu().text(o._focusMenu().text()),o.focusMenu().description(o._focusMenu().description()),o.focusMenu().link(""==o._focusMenu().link()?"javascript:void(0);":o._focusMenu().link()),o._focusMenu(o.getNewNode()),o.focusMenu(o.getNewNode())},o.addSubMenu=function(){return o.isEmpty()?(u(".ui.basic.modal").modal("show"),!1):(e.isObservable(o.focusMenu().submenus)||(o.focusMenu().submenus=e.observableArray([])),o.focusMenu().submenus.push(o._focusMenu()),void o._focusMenu(o.getNewNode()))},o.move=function(){var e=o.focusMenu().submenus().indexOf(this);o.focusMenu().submenus.remove(this),o.focusMenu().submenus.splice(e-1,0,this)},o.down=function(){var e=o.focusMenu().submenus().indexOf(this);o.focusMenu().submenus.remove(this),o.focusMenu().submenus.splice(e+1,0,this)},o.removeMenu=function(){o.focusMenu().submenus.remove(this)},o.parent.loading(!1),o.data.test&&(main=o)}});